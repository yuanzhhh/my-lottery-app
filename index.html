<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å¹´ä¼šå¹¸è¿å¤§æŠ½å¥–</title>
    <style>
      :root {
        --primary-bg: #450a0a; /* deep red */
        --secondary-bg: #7f1d1d; /* lighter red */
        --accent-gold: #fbbf24; /* gold */
        --accent-gold-dark: #b45309;
        --text-light: #fef3c7;
        --text-white: #ffffff;
      }

      * {
        box-sizing: border-box;
        user-select: none; /* é˜²æ­¢æŠ½å¥–æ—¶è¯¯é€‰ä¸­æ–‡æœ¬ */
      }

      body {
        margin: 0;
        padding: 0;
        font-family: "Microsoft YaHei", sans-serif;
        background-color: var(--primary-bg);
        background-image: radial-gradient(
          circle at center,
          #7f1d1d 1px,
          transparent 1px
        );
        background-size: 30px 30px;
        color: var(--text-light);
        height: 100vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      /* é¡¶éƒ¨æ ‡é¢˜ */
      header {
        text-align: center;
        padding: 20px;
        background: linear-gradient(to right, #450a0a, #7f1d1d, #450a0a);
        border-bottom: 2px solid var(--accent-gold-dark);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        z-index: 10;
      }

      h1 {
        margin: 0;
        font-size: 2.5rem;
        background: linear-gradient(to bottom, #fde68a, #d97706);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .subtitle {
        margin-top: 5px;
        font-size: 0.9rem;
        color: rgba(254, 243, 199, 0.7);
      }

      /* ä¸»å¸ƒå±€ */
      main {
        flex: 1;
        display: flex;
        padding: 20px;
        gap: 20px;
        overflow: hidden;
      }

      /* é€šç”¨é¢æ¿æ ·å¼ */
      .panel {
        background: rgba(69, 10, 10, 0.85);
        border: 2px solid rgba(180, 83, 9, 0.5);
        border-radius: 12px;
        display: flex;
        flex-direction: column;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(4px);
      }

      .panel-header {
        padding: 15px;
        background: rgba(127, 29, 29, 0.5);
        border-bottom: 1px solid rgba(180, 83, 9, 0.3);
        font-weight: bold;
        color: var(--accent-gold);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .panel-content {
        flex: 1;
        overflow-y: auto;
        padding: 10px;
      }

      /* æ»šåŠ¨æ¡æ ·å¼ */
      ::-webkit-scrollbar {
        width: 6px;
      }
      ::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.1);
      }
      ::-webkit-scrollbar-thumb {
        background: var(--accent-gold-dark);
        border-radius: 3px;
      }

      /* å·¦ä¾§ï¼šä¸­å¥–åå• */
      .left-col {
        width: 25%;
      }

      .winner-item {
        display: flex;
        align-items: center;
        background: linear-gradient(to right, #7f1d1d, #991b1b);
        margin-bottom: 8px;
        padding: 10px;
        border-radius: 6px;
        border-left: 4px solid var(--accent-gold);
        animation: slideIn 0.5s ease-out;
      }

      .winner-num {
        width: 36px;
        height: 36px;
        background: var(--accent-gold);
        color: var(--primary-bg);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.1rem;
        margin-right: 10px;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .winner-info h4 {
        margin: 0;
        font-size: 0.9rem;
        color: #fde68a;
      }
      .winner-info p {
        margin: 2px 0 0;
        font-size: 0.8rem;
        color: #fca5a5;
      }

      /* ä¸­é—´ï¼šæŠ½å¥–åŒº */
      .center-col {
        width: 50%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
      }

      .current-prize-display {
        text-align: center;
        margin-bottom: 30px;
        height: 80px;
      }

      .current-prize-title {
        color: var(--accent-gold);
        letter-spacing: 2px;
        font-size: 1.2rem;
        margin-bottom: 5px;
      }

      .current-prize-name {
        font-size: 2.5rem;
        font-weight: bold;
        color: white;
        text-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
      }

      .rolling-circle {
        width: 320px;
        height: 320px;
        border-radius: 50%;
        background: radial-gradient(circle at 30% 30%, #b91c1c, #450a0a);
        border: 8px solid var(--accent-gold);
        box-shadow: 0 0 50px rgba(251, 191, 36, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 40px;
        position: relative;
        transition: transform 0.1s;
      }

      .rolling-number {
        font-size: 10rem;
        font-weight: 900;
        background: linear-gradient(to bottom, #fffbeb, #fbbf24);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        font-family: Arial, sans-serif;
      }

      /* æŒ‰é’®æ ·å¼ */
      .btn-start {
        background: linear-gradient(to bottom, #f59e0b, #d97706);
        border: none;
        padding: 15px 60px;
        border-radius: 50px;
        font-size: 1.8rem;
        font-weight: bold;
        color: #450a0a;
        cursor: pointer;
        box-shadow: 0 6px 0 #92400e, 0 15px 20px rgba(0, 0, 0, 0.4);
        transition: all 0.1s;
        outline: none;
      }

      .btn-start:active {
        transform: translateY(6px);
        box-shadow: 0 0 0 #92400e, 0 5px 10px rgba(0, 0, 0, 0.4);
      }

      .btn-start:disabled {
        background: #4b5563;
        color: #9ca3af;
        box-shadow: none;
        cursor: not-allowed;
        transform: none;
      }

      /* å³ä¾§ï¼šå¥–å“åˆ—è¡¨ */
      .right-col {
        width: 25%;
      }

      .prize-item {
        padding: 12px;
        background: rgba(0, 0, 0, 0.2);
        margin-bottom: 8px;
        border-radius: 6px;
        cursor: pointer;
        border: 1px solid transparent;
        transition: all 0.2s;
      }

      .prize-item:hover {
        background: rgba(0, 0, 0, 0.4);
      }

      .prize-item.active {
        background: linear-gradient(
          to right,
          rgba(180, 83, 9, 0.6),
          rgba(180, 83, 9, 0.2)
        );
        border-color: var(--accent-gold);
        box-shadow: 0 0 15px rgba(251, 191, 36, 0.2);
      }

      .prize-title {
        font-size: 0.8rem;
        color: var(--accent-gold);
      }
      .prize-name {
        font-size: 1.1rem;
        font-weight: bold;
        color: white;
      }

      /* æ·»åŠ å¥–å“è¡¨å• */
      .add-prize-form {
        display: none;
        padding: 10px;
        background: rgba(0, 0, 0, 0.3);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }
      .add-prize-form.show {
        display: block;
        animation: slideDown 0.3s;
      }

      .input-group {
        margin-bottom: 8px;
      }

      input {
        width: 100%;
        padding: 8px;
        border-radius: 4px;
        border: 1px solid #7f1d1d;
        background: #450a0a;
        color: white;
        outline: none;
      }
      input:focus {
        border-color: var(--accent-gold);
      }

      .btn-add {
        width: 100%;
        padding: 6px;
        background: var(--accent-gold-dark);
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      .btn-icon {
        background: none;
        border: none;
        color: var(--accent-gold);
        cursor: pointer;
        font-size: 1.2rem;
        transition: transform 0.2s;
      }
      .btn-icon:hover {
        transform: scale(1.2);
      }

      /* åŠ¨ç”» */
      @keyframes slideIn {
        from {
          transform: translateX(-20px);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @keyframes bump {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.02);
        }
        100% {
          transform: scale(1);
        }
      }
      .bump {
        animation: bump 0.1s ease-in-out;
      }

      /* å“åº”å¼ */
      @media (max-width: 1024px) {
        main {
          flex-direction: column;
          overflow-y: auto;
        }
        .left-col,
        .center-col,
        .right-col {
          width: 100%;
          height: auto;
        }
        .left-col {
          order: 3;
          max-height: 300px;
        }
        .center-col {
          order: 1;
          padding: 40px 0;
        }
        .right-col {
          order: 2;
          max-height: 300px;
        }

        .rolling-circle {
          width: 220px;
          height: 220px;
        }
        .rolling-number {
          font-size: 6rem;
        }
        .current-prize-display {
          height: auto;
          margin-bottom: 20px;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>å¹¸è¿è½è°å®¶ Â· å¹´ä¼šç››å…¸</h1>
      <div class="subtitle">
        å‰©ä½™å·ç : <span id="remaining-count">100</span> / 100
      </div>
    </header>

    <main>
      <!-- å·¦ä¾§ï¼šä¸­å¥–åå• -->
      <section class="panel left-col">
        <div class="panel-header">
          <span>ğŸ† å¹¸è¿æ¦œå•</span>
        </div>
        <div class="panel-content" id="winner-list">
          <!-- ä¸­å¥–è€…å°†æ’å…¥è¿™é‡Œ -->
          <div
            style="
              text-align: center;
              color: rgba(255, 255, 255, 0.3);
              padding-top: 20px;
              font-style: italic;
            "
          >
            è™šä½ä»¥å¾…...
          </div>
        </div>
      </section>

      <!-- ä¸­é—´ï¼šæ»šåŠ¨åŒº -->
      <section class="center-col">
        <div class="current-prize-display">
          <div class="current-prize-title" id="current-prize-title">
            è¯·é€‰æ‹©å¥–å“
          </div>
          <div class="current-prize-name" id="current-prize-name">---</div>
        </div>

        <div class="rolling-circle" id="rolling-circle">
          <div class="rolling-number" id="display-number">00</div>
        </div>

        <button class="btn-start" id="btn-start" disabled>å¼€å§‹æŠ½å¥–</button>
      </section>

      <!-- å³ä¾§ï¼šå¥–å“åˆ—è¡¨ -->
      <section class="panel right-col">
        <div class="panel-header">
          <span>ğŸ å¥–å“åˆ—è¡¨</span>
          <button class="btn-icon" onclick="toggleAddPrize()" title="æ·»åŠ å¥–å“">
            +
          </button>
        </div>

        <div class="add-prize-form" id="add-prize-form">
          <div class="input-group">
            <input
              type="text"
              id="new-prize-title"
              placeholder="å¥–é¡¹ (å¦‚: ç‰¹ç­‰å¥–)"
            />
          </div>
          <div class="input-group">
            <input
              type="text"
              id="new-prize-name"
              placeholder="å¥–å“ (å¦‚: ç°é‡‘çº¢åŒ…)"
            />
          </div>
          <button class="btn-add" onclick="addNewPrize()">ç¡®å®šæ·»åŠ </button>
        </div>

        <div class="panel-content" id="prize-list">
          <!-- å¥–å“åˆ—è¡¨JSç”Ÿæˆ -->
        </div>
      </section>
    </main>

    <script>
      // --- æ•°æ®åˆå§‹åŒ– ---
      let prizes = [
        { id: 1, title: "å¸½ç¾å¦‚èŠ±", name: "å¨å°”é€Šå¸½å­" },
        { id: 2, title: "æŸ”æ‰‹è¿æ˜¥", name: "ç¥–ç›ç‘æŠ¤æ‰‹éœœ" },
        { id: 3, title: "åŒ…ç½—ä¸‡è±¡", name: "å°é¹°åŒè‚©åŒ…" },
        { id: 4, title: "ä¹äº«å…¶ç¨‹", name: "é©¬æ­‡å°”éŸ³å“" },
        { id: 5, title: "ä¸€æ‹å³èƒœ", name: "æå®ç¾½æ¯›çƒæ‹" },
        { id: 6, title: "å¾‹åŠ¨éšè¡Œ", name: "ä½³æ˜è¿åŠ¨æ‰‹è¡¨" },
        { id: 7, title: "è¡Œæ‘„æ— ç–†", name: "å¤§ç–† Pocket3" },
        { id: 8, title: "é¥é¥é¢†å…ˆ", name: "æ‰‹æœº" },
      ];

      // ç”Ÿæˆ 1-100 çš„å·ç 
      let availableNumbers = Array.from({ length: 100 }, (_, i) => i + 1);
      let selectedPrizeId = null;
      let isRolling = false;

      // --- DOM å…ƒç´  ---
      const els = {
        remainingCount: document.getElementById("remaining-count"),
        winnerList: document.getElementById("winner-list"),
        prizeList: document.getElementById("prize-list"),
        displayNumber: document.getElementById("display-number"),
        rollingCircle: document.getElementById("rolling-circle"),
        currentPrizeTitle: document.getElementById("current-prize-title"),
        currentPrizeName: document.getElementById("current-prize-name"),
        btnStart: document.getElementById("btn-start"),
        addForm: document.getElementById("add-prize-form"),
        newPrizeTitle: document.getElementById("new-prize-title"),
        newPrizeName: document.getElementById("new-prize-name"),
      };

      // --- åˆå§‹åŒ–æ¸²æŸ“ ---
      renderPrizeList();

      // --- æ ¸å¿ƒåŠŸèƒ½å‡½æ•° ---

      function renderPrizeList() {
        els.prizeList.innerHTML = "";
        prizes.forEach((prize) => {
          const div = document.createElement("div");
          div.className = `prize-item ${
            selectedPrizeId === prize.id ? "active" : ""
          }`;
          div.innerHTML = `
                    <div class="prize-title">${prize.title}</div>
                    <div class="prize-name">${prize.name}</div>
                `;
          div.onclick = () => {
            if (isRolling) return;
            selectedPrizeId = prize.id;
            renderPrizeList(); // é‡æ–°æ¸²æŸ“ä»¥æ›´æ–°é«˜äº®
            updateStatusDisplay(prize);
            checkStartButton();
          };
          els.prizeList.appendChild(div);
        });
      }

      function updateStatusDisplay(prize) {
        if (prize) {
          els.currentPrizeTitle.innerText = `æ­£åœ¨æŠ½å–: ${prize.title}`;
          els.currentPrizeName.innerText = prize.name;
          els.currentPrizeTitle.style.color = "#fbbf24";
        } else {
          els.currentPrizeTitle.innerText = "è¯·é€‰æ‹©å¥–å“";
          els.currentPrizeName.innerText = "---";
        }
      }

      function checkStartButton() {
        els.btnStart.disabled =
          !selectedPrizeId || isRolling || availableNumbers.length === 0;
        if (availableNumbers.length === 0) {
          els.btnStart.innerText = "å·²æŠ½å®Œ";
        } else if (isRolling) {
          els.btnStart.innerText = "æŠ½å¥–ä¸­...";
        } else {
          els.btnStart.innerText = "å¼€å§‹æŠ½å¥–";
        }
      }

      function toggleAddPrize() {
        els.addForm.classList.toggle("show");
      }

      function addNewPrize() {
        const title = els.newPrizeTitle.value.trim();
        const name = els.newPrizeName.value.trim();
        if (!name) {
          alert("è¯·è¾“å…¥å¥–å“åç§°");
          return;
        }
        const newId =
          prizes.length > 0 ? Math.max(...prizes.map((p) => p.id)) + 1 : 1;
        prizes.push({ id: newId, title: title || "è¿½åŠ å¤§å¥–", name: name });
        els.newPrizeTitle.value = "";
        els.newPrizeName.value = "";
        toggleAddPrize();
        renderPrizeList();
      }

      // è¾…åŠ©ï¼šç¡çœ å‡½æ•°
      const sleep = (ms) => new Promise((r) => setTimeout(r, ms));

      // è¾…åŠ©ï¼šè·å–éšæœºå±•ç¤ºæ•°å­— (ä¸ä¸€å®šæ˜¯æœ€ç»ˆç»“æœï¼Œä»…ç”¨äºåŠ¨ç”»)
      const getRandomDisplay = () => Math.floor(Math.random() * 100) + 1;

      // --- æ ¸å¿ƒé€»è¾‘ï¼šæŠ½å¥– ---
      els.btnStart.onclick = async () => {
        if (isRolling || !selectedPrizeId || availableNumbers.length === 0)
          return;

        isRolling = true;
        checkStartButton();

        // 1. ç¡®å®šä¸­å¥–ç»“æœ (æå‰é”å®š)
        const randomIndex = Math.floor(Math.random() * availableNumbers.length);
        const winningNumber = availableNumbers[randomIndex];

        // 2. è¶£å‘³å˜é€ŸåŠ¨ç”»
        // é˜¶æ®µ 1: æé€Ÿ (å¼•æ“é¢„çƒ­)
        let speed = 50;
        for (let i = 0; i < 20; i++) {
          updateDisplay(getRandomDisplay());
          await sleep(speed);
        }

        // é˜¶æ®µ 2: å‡é€Ÿ (åˆ¶é€ æ‚¬å¿µ)
        for (let i = 0; i < 15; i++) {
          updateDisplay(getRandomDisplay());
          speed += 20;
          await sleep(speed);
        }

        // é˜¶æ®µ 3: çªç„¶åŠ é€Ÿ (æˆå¼„)
        speed = 40;
        for (let i = 0; i < 25; i++) {
          updateDisplay(getRandomDisplay());
          await sleep(speed);
        }

        // é˜¶æ®µ 4: æœ€ç»ˆå‡é€Ÿé”å®š
        for (let i = 0; i < 10; i++) {
          updateDisplay(getRandomDisplay());
          speed += 40;
          await sleep(speed);
        }

        // 3. æ˜¾ç¤ºç»“æœ
        updateDisplay(winningNumber);

        // 4. æ•°æ®æ›´æ–°
        // ä»å·ç æ± ç§»é™¤
        availableNumbers.splice(randomIndex, 1);
        els.remainingCount.innerText = availableNumbers.length;

        // æ·»åŠ åˆ°ä¸­å¥–åå•
        const prize = prizes.find((p) => p.id === selectedPrizeId);
        addWinnerToList(winningNumber, prize);

        // çŠ¶æ€é‡ç½®
        isRolling = false;
        checkStartButton();
      };

      function updateDisplay(num) {
        els.displayNumber.innerText = num < 10 ? "0" + num : num;
        // æ·»åŠ è·³åŠ¨åŠ¨ç”»ç±»
        els.rollingCircle.classList.remove("bump");
        void els.rollingCircle.offsetWidth; // è§¦å‘é‡ç»˜
        els.rollingCircle.classList.add("bump");
      }

      function addWinnerToList(number, prize) {
        // ç§»é™¤"è™šä½ä»¥å¾…"å ä½ç¬¦
        if (els.winnerList.children[0]?.style.fontStyle === "italic") {
          els.winnerList.innerHTML = "";
        }

        const div = document.createElement("div");
        div.className = "winner-item";
        div.innerHTML = `
                <div class="winner-num">${number}</div>
                <div class="winner-info">
                    <h4>${prize.title}</h4>
                    <p>${prize.name}</p>
                </div>
            `;
        // æ’å…¥åˆ°æœ€å‰é¢
        els.winnerList.insertBefore(div, els.winnerList.firstChild);
      }
    </script>
  </body>
</html>
